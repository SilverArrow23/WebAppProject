<!DOCTYPE html>
<html lang="es-es">
	<head>
		<title>Informaci&oacute;n alumno</title>
		<meta charset="ISO-8859-1" />
		<script src = "js/jquery.js"></script> 
		<script>
		function onInicio(){
			setTimeout(datosAl(asigAl()),1000);
			
				
}	
		function datosAl(){
			$.get("/NOB_Project/DatoAlumnoServlet",function(data){			

				response = $.parseJSON(data);

				$(function() {
					$('#Alumno').append(
						$('<tr>').append(
					            $('<td>').text('Nombre'),					            
					            $('<td>').text('Apellidos'),
					            $('<td>').text('dni')      
					    )		
					);				
				        $('#Alumno').append(			        		
			        		$('<tr id='+data.dni+'>').append(
						            $('<td>').text(response.nombre),
						            $('<td>').text(response.apellidos),
						            $('<td>').text(response.dni)  
						    )
				        );
				});
			});	
				}
		
		function asigAl(){
			var acr = "";
		$.get("/NOB_Project/listaAsigAlumno",function(data){			
				
				response = $.parseJSON(data);

				console.log("sin parsear" + data);
				
				console.log("ya parseado" + response);
					
				$(function() {
					$('#Asignaturas').append(
						$('<tr>').append(
					            $('<td>').text('Asignatura'),	
					            $('<td>').text('Nota')
					               
					    )		
					);				
				    $.each(response, function(i, item) {
				    	if(item.asignatura == acr){
				        $('#Asignaturas').append(			        		
			        		$('<tr id="'+ item.asignatura + '">').append(
						            $('<td>').text(item.asignatura),
						            $('<td>').text(item.nota),
						            $('<td>').append(
                                        $('<button form="form" onclick="cambiarNota()" id="modificar" class="btn2 btn-lg btn-primary btn-block" value="'+item.nota+'" name="modificar">Modificar</button>'))
						            
						    )
				        );
				    	}
				    });
				});
		});
		$.get("/NOB_Project/ObtenerAcrProfesor",function(data){
			
			acr = data;
			console.log(acr);
			
		});
		}
		
		
		function cambiarNota(){
			var mensaje;
	        var nota = prompt("Introduzca la nueva Nota:",);

	        if (nota == null || nota == "" || nota < 0 || nota > 10) {
	                alert("El valor no ha sido introducido o no es válido");
	                }
	        else {
	        	$('#modificar').prop('value',nota);
	        	/*$.get("/NOB_Project/CambiaNotaServlet",function(){
	        		console.log("La nota se ha modificado con éxito");
	        	 	
	        	});*/
	        	$('#form').submit();
			}
	        
	     }
	        

	    
		
		
		$('document').ready(onInicio());
				
	</script>
	</head>
	<body>
	<h1>Datos Personales Alumno</h1>
		<div id="insertar">
			<table id="Alumno"></table>
			<table id="Asignaturas"></table>
			<form id="form" action ="/NOB_Project/CambiaNotaServlet" method= "get">
			</form>
		</div>
	</body>
</html>