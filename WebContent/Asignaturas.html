<!DOCTYPE html>
<html>
<head>
	<meta charset="ISO-8859-1">
	<title>Insert title here</title>
	<script src="https://code.jquery.com/jquery-1.9.1.min.js"></script>
	<script>
	function onInicio(){
		$.get("/NOB_Project/AsignaturaServlet",function(data){			
			
			response = $.parseJSON(data);

			$(function() {
				$('#Asignaturas').append(
					$('<tr>').append(
				            $('<td>').text('Acronimo'),					            
				            $('<td>').text('Nombre'),
				            $('<td>').text('Curso'),
				            $('<td>').text('Cuatrimestre'),
				            $('<td>').text('Creditos')
				    )		
				);				
			    $.each(response, function(i, item) {
			        $('#Asignaturas').append(			        		
		        		$('<tr id='+item.acronimo+'>').append(
					            $('<td>').append(					            		
					            		$('<button id='+item.acronimo+' onclick="cambiar()" value='+item.acronimo+' name="boton">'+item.acronimo+'</button>')),				            
					            $('<td>').text(item.nombre),
					            $('<td>').text(item.curso),
					            $('<td>').text(item.cuatrimestre),
					            $('<td>').text(item.creditos)
					    )
			        );
			    });
			});
		});
		
		/*$(':button').click(function(){
			/*console.log($(this).parent().parent().prop('id'));
			$.post("/NOB_Project/AlumnoServlet",function(data){
				$(this).attr('id').html(data);
				console.log($(this).parent().parent().prop('id'));
			});
			$('#acrOculto').val('hola');		
		});*/
		
		/*function cambiar(){
            var botonId = this.id;
            $("#form").submit(function(e){
                 e.preventDefault();//stop submit event
                 var self = $(this);//this form
                 $("#acrOculto").val(botonId);//change input
                 $("#form").off("submit");//need form submit event off.
                 self.submit();//submit form
           });
        }*/
        
		function cambiar(){
        	 $("#form").submit();
        }
	}
	
	$('document').ready(onInicio(function(){
	    //miramos si tiene '#' la url
	    if(document.URL.indexOf("#")==-1){
	        // si no se ha cargado aún añadimos "#"
	        url = document.URL+"#";
	        location = "#";

	        //recargamos para que tenga los datos si o si ?? 
	        location.reload(true);
	    }
	}))

	</script>
</head>
<body>
	<div>
		<h1>Lista asignaturas</h1>
		<form id="form" action ="/NOB_Project/listaAlumServlet" method= "get">
			<table id="Asignaturas"></table>
		</form>
		
		
		<form id="logOut" action ="/NOB_Project/logOutServlet" method= "get">
			<button type="submit" value="LogOut">Cerrar Sesi&oacuten</button>
		</form>
	</div>
</body>
</html>